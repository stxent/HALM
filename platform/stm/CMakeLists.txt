#Copyright (C) 2017 xent
#Project is distributed under the terms of the GNU General Public License v3.0

set(SOURCE_FILES "")
set(SOURCE_FILES_LIST "")

string(TOLOWER ${PLATFORM} CMAKE_SYSTEM_SOC)
set(CMAKE_SYSTEM_VENDOR "stm")
set(FLAGS_PLATFORM "-D${PLATFORM}")

list(APPEND SOURCE_FILES "pin.c")
list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/startup.c")
list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/${CMAKE_SYSTEM_SOC}/clocking.c")
list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/${CMAKE_SYSTEM_SOC}/pin.c")
list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/${CMAKE_SYSTEM_SOC}/startup.c")
list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/${CMAKE_SYSTEM_SOC}/system.c")
list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/${CMAKE_SYSTEM_SOC}/vectors.c")

if(${CONFIG_PM})
    list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/${CMAKE_SYSTEM_SOC}/pm.c")
endif()

if(${CONFIG_PLATFORM_STM_UART_BASE})
    list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/uart_common.c")
    list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/${CMAKE_SYSTEM_SOC}/uart_base.c")
endif()

if(${CONFIG_PLATFORM_STM_SERIAL})
    list(APPEND SOURCE_FILES "${CMAKE_SYSTEM_VENDOR}/serial.c")
endif()

prepend(SOURCE_FILES_LIST "${PROJECT_SOURCE_DIR}/platform" ${SOURCE_FILES})
list(APPEND LIBRARY_SOURCES "${SOURCE_FILES_LIST}")
